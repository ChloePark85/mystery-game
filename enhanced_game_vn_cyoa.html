<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0ì˜ ì§‘í–‰ - Choose Your Own Adventure</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            font-family: 'Segoe UI', 'Noto Sans CJK KR', sans-serif;
            height: 100%;
            overflow: hidden;
        }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .vn-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: #000;
        }

        /* í’€ìŠ¤í¬ë¦° ë°°ê²½ ì´ë¯¸ì§€ */
        .vn-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .vn-bg-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.8);
        }

        /* ìƒë‹¨ í—¤ë” */
        .vn-header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            z-index: 10;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), rgba(0,0,0,0));
            padding: 20px;
            color: white;
        }

        .vn-title {
            font-size: 1.5em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .vn-progress {
            width: 400px;
            height: 4px;
            background: rgba(255,255,255,0.3);
            border-radius: 2px;
            margin: 10px 0 5px 0;
        }

        .vn-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4fc3f7, #29b6f6);
            border-radius: 2px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .vn-scene-info {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .vn-path-indicator {
            margin-top: 5px;
            padding: 5px 12px;
            border-radius: 15px;
            display: inline-block;
            font-size: 0.85em;
            font-weight: bold;
        }

        .path-detective {
            background: rgba(66, 165, 245, 0.8);
        }

        .path-conspiracy {
            background: rgba(255, 87, 34, 0.8);
        }

        .path-drama {
            background: rgba(156, 39, 176, 0.8);
        }

        /* í•˜ë‹¨ ëŒ€í™” UI */
        .vn-dialogue-container {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 10;
            background: linear-gradient(to top, rgba(0,0,0,0.9), rgba(0,0,0,0.7));
            padding: 20px;
            min-height: 200px;
        }

        /* ìºë¦­í„° ì´ë¦„ ë°•ìŠ¤ */
        .vn-character-name {
            background: rgba(66, 165, 245, 0.9);
            color: white;
            padding: 8px 20px;
            border-radius: 20px 20px 0 0;
            font-weight: bold;
            display: inline-block;
            margin-bottom: -1px;
            font-size: 0.95em;
        }

        /* ëŒ€í™” ë°•ìŠ¤ */
        .vn-dialogue-box {
            background: rgba(255,255,255,0.95);
            color: #333;
            padding: 20px;
            border-radius: 10px;
            min-height: 100px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .vn-text {
            font-size: 1.1em;
            line-height: 1.6;
        }

        /* ì„ íƒì§€ */
        .vn-choices {
            margin-top: 15px;
        }

        .vn-choice {
            background: rgba(66, 165, 245, 0.9);
            color: white;
            padding: 15px 25px;
            margin: 10px 0;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
            font-size: 1em;
            font-weight: 500;
        }

        .vn-choice:hover {
            background: rgba(66, 165, 245, 1);
            border-color: rgba(255,255,255,0.5);
            transform: scale(1.02);
        }

        .choice-detective {
            background: rgba(33, 150, 243, 0.9);
        }

        .choice-conspiracy {
            background: rgba(255, 87, 34, 0.9);
        }

        .choice-drama {
            background: rgba(156, 39, 176, 0.9);
        }

        /* ê³„ì†í•˜ê¸° ë²„íŠ¼ */
        .vn-continue {
            position: absolute;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: rgba(66, 165, 245, 0.8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            animation: pulse 2s infinite;
        }

        .vn-continue:hover {
            background: rgba(66, 165, 245, 1);
            transform: scale(1.1);
        }

        .continue-indicator {
            color: white;
            font-size: 1.2em;
            font-weight: bold;
            margin-left: 3px;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* ì„ íƒ í”¼ë“œë°± */
        .choice-feedback {
            background: rgba(33, 150, 243, 0.2);
            color: #2196f3;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .hidden {
            display: none !important;
        }

        /* ì—”ë”© íƒ€ì´í‹€ */
        .ending-title {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 15;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 30px 50px;
            border-radius: 15px;
            text-align: center;
            font-size: 2em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            animation: fadeIn 1s ease;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .vn-dialogue-container {
                padding: 15px;
            }

            .vn-header {
                padding: 15px;
            }

            .vn-progress {
                width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="vn-container">
        <!-- ë°°ê²½ ì´ë¯¸ì§€ (í’€ìŠ¤í¬ë¦°) -->
        <div class="vn-background">
            <img id="sceneImage" class="vn-bg-image" src="" alt="Scene Background">
        </div>

        <!-- ìƒë‹¨ ì •ë³´ -->
        <div class="vn-header">
            <div class="vn-title">0ì˜ ì§‘í–‰ - Choose Your Own Adventure</div>
            <div class="vn-progress">
                <div class="vn-progress-bar" id="progressBar"></div>
            </div>
            <div class="vn-scene-info">
                <span id="phaseIndicator"></span> - <span id="sceneNumber"></span>
                <div class="vn-path-indicator" id="pathIndicator" style="display: none;"></div>
            </div>
        </div>

        <!-- í•˜ë‹¨ ëŒ€í™” UI -->
        <div class="vn-dialogue-container">
            <!-- ìºë¦­í„° ì´ë¦„ ë°•ìŠ¤ -->
            <div class="vn-character-name" id="characterName">ë‚´ë ˆì´ì…˜</div>

            <!-- ëŒ€í™” ë‚´ìš© ë°•ìŠ¤ -->
            <div class="vn-dialogue-box">
                <div class="vn-text" id="dialogueText">
                    <!-- ëŒ€í™” ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ì„ íƒì§€ -->
            <div class="vn-choices" id="vnChoices"></div>

            <!-- ê³„ì†í•˜ê¸° ë²„íŠ¼ -->
            <div class="vn-continue" id="vnContinue" onclick="nextDialogue()">
                <div class="continue-indicator">â–¶</div>
            </div>
        </div>

        <!-- ì—”ë”© íƒ€ì´í‹€ í‘œì‹œ -->
        <div id="endingTitle" class="ending-title hidden"></div>
    </div>

    <script>
        let currentDialogue = 0;
        let selectedPath = null; // detective, conspiracy, drama
        let pathPhase = 1; // ê° ê²½ë¡œë³„ ì§„í–‰ ë‹¨ê³„

        // ëª¨ë“  ëŒ€ì‚¬ ë°ì´í„°
        const dialogues = {
            // ê³µí†µ ë„ì…ë¶€ (4ê°œ)
            common: [
                {
                    image: 'game/images/scenes/scene_01.png',
                    phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                    title: "ê¸´ê¸‰ í˜¸ì¶œ",
                    speaker: "ë‚´ë ˆì´ì…˜",
                    content: "<strong>2024ë…„ 3ì›” 15ì¼, ì˜¤í›„ 11ì‹œ 30ë¶„</strong><br>ì„œìš¸ ê°•ë‚¨êµ¬ ë°ì´í„° í¬ë Œì‹ ì‚¬ë¬´ì†Œ"
                },
                {
                    image: 'game/images/scenes/scene_01.png',
                    phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                    title: "ê¸´ê¸‰ í˜¸ì¶œ",
                    speaker: "ê²½ì°°ì„œ",
                    content: "ì§„ íƒì •ë‹˜, ê¸´ê¸‰ì‚¬ê±´ì…ë‹ˆë‹¤. ê°•ë‚¨êµ¬ ì•„ë¥´ì¹´ë””ì•„ ë§¨ì…˜ì—ì„œ ì˜ë¬¸ì‚¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
                },
                {
                    image: 'game/images/scenes/scene_02.png',
                    phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                    title: "í˜„ì¥ ë„ì°©",
                    speaker: "ë‚´ë ˆì´ì…˜",
                    content: "ì²¨ë‹¨ ê¸°ìˆ ë¡œ ë¬´ì¥í•œ ìŠ¤ë§ˆíŠ¸ ë§¨ì…˜. í”¼í•´ìëŠ” ê°•ë°•ì‚¬(58ì„¸), ì»´í“¨í„° ê³µí•™ êµìˆ˜ì…ë‹ˆë‹¤."
                },
                {
                    image: 'game/images/scenes/scene_03.png',
                    phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                    title: "ì‚¬ê±´ ë¸Œë¦¬í•‘",
                    speaker: "ë‚´ë ˆì´ì…˜",
                    content: "ì§€í•˜ ì—°êµ¬ì‹¤ì—ì„œ ê°•ë°•ì‚¬ê°€ ë¡œë´‡ íŒ”ì— ëª©ì´ ëˆŒë ¤ ì‚¬ë§. í˜„ì¥ì—ëŠ” ë‘ ëª…ì˜ ê´€ë ¨ìê°€ ìˆìŠµë‹ˆë‹¤."
                },
                {
                    image: 'game/images/scenes/scene_04.png',
                    phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                    title: "ìˆ˜ì‚¬ ë°©í–¥ ì„ íƒ",
                    speaker: "ì§„",
                    content: "ì„¸ ê°€ì§€ ì ‘ê·¼ ë°©ì‹ì´ ìˆë‹¤. ì–´ë–¤ ë°©í–¥ìœ¼ë¡œ ìˆ˜ì‚¬í• ê¹Œ?",
                    choices: [
                        "ğŸ”¬ ê³¼í•™ì  ë¶„ì„ì— ì§‘ì¤‘í•œë‹¤",
                        "ğŸ•µï¸ ìˆ¨ê²¨ì§„ ìŒëª¨ë¥¼ ì¶”ì í•œë‹¤",
                        "ğŸ’­ ì¸ê°„ê´€ê³„ë¥¼ íŒŒì•…í•œë‹¤"
                    ],
                    choice_types: ['detective', 'conspiracy', 'drama']
                }
            ],

            // Detective Path
            detective: [
                {
                    image: 'game/images/scenes/detective_01.png',
                    phase: "ğŸ•µï¸ Detective - Phase 1: ê³¼í•™ì  ë¶„ì„",
                    title: "ì„¬ìœ  ë¶„ì„",
                    speaker: "ì§„",
                    content: "í˜„ë¯¸ê²½ìœ¼ë¡œ ë¡œë´‡ íŒ”ì—ì„œ ë°œê²¬ëœ ì„¬ìœ ë¥¼ ë¶„ì„í•´ë³´ì. ì´ ì‘ì€ ì¡°ê°ì´ ì‚¬ê±´ì˜ ì—´ì‡ ê°€ ë  ìˆ˜ ìˆì–´."
                },
                {
                    image: 'game/images/scenes/detective_02.png',
                    phase: "ğŸ•µï¸ Detective - Phase 1: ê³¼í•™ì  ë¶„ì„",
                    title: "3D êµ¬ì¡° ë¶„ì„",
                    speaker: "ì§„",
                    content: "ë¡œë´‡ íŒ”ì˜ êµ¬ì¡°ë¥¼ 3Dë¡œ ë¶„ì„í•´ë³´ì. ì´ ê´€ì ˆ ë¶€ë¶„... ì¤‘ë ¥ì— ì˜í•´ ìë™ìœ¼ë¡œ ë‹«íˆëŠ” êµ¬ì¡°ë¡œ ë˜ì–´ ìˆì–´."
                },
                {
                    image: 'game/images/scenes/detective_03.png',
                    phase: "ğŸ•µï¸ Detective - Phase 1: ê³¼í•™ì  ë¶„ì„",
                    title: "ì‹¬ë°•ìˆ˜ ë°ì´í„°",
                    speaker: "ì§„",
                    content: "ìœ ì§€ë¯¼ì˜ ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ ë°ì´í„°ë¥¼ íƒ€ì„ë¼ì¸ê³¼ ëŒ€ì¡°í•´ë³´ì. 20ì‹œ 55ë¶„ì— ì‹¬ë°•ìˆ˜ê°€ ê¸‰ìƒìŠ¹í–ˆì–´."
                },
                {
                    image: 'game/images/scenes/detective_04.png',
                    phase: "ğŸ•µï¸ Detective - Phase 2: ë…¼ë¦¬ì  ì¶”ë¡ ",
                    title: "ì¦ê±° ì—°ê²°",
                    speaker: "ì§„",
                    content: "ëª¨ë“  ì¦ê±°ë¥¼ ì—°ê²°í•´ë³´ì. ë¬¼ë¦¬ì  ì¦ê±°, ì‹œê°„, ê·¸ë¦¬ê³  ë™ê¸°...",
                    choices: [
                        "ì¦ê±°ë¥¼ ë” ìˆ˜ì§‘í•œë‹¤",
                        "ì‹¬ë¦¬ì  ì••ë°•ì„ ê°€í•œë‹¤"
                    ],
                    choice_types: ['evidence_route', 'interrogation_route']
                },
                {
                    image: 'game/images/scenes/detective_06.png',
                    phase: "ğŸ•µï¸ Detective - Phase 2: ì¦ê±° ìˆ˜ì§‘",
                    title: "í¬ë Œì‹ ë¶„ì„",
                    speaker: "ì§„",
                    content: "ê³ ê¸‰ ë¶„ì„ ì†Œí”„íŠ¸ì›¨ì–´ë¡œ 3D ì¬êµ¬ì„±ì„ í•´ë³´ì. ì—¬ê¸°ì•¼! ì´ ì§€ì ì—ì„œ ë„¥íƒ€ì´ê°€ ê±¸ë ¸ê³ ...",
                    branch: "evidence_route"
                },
                {
                    image: 'game/images/scenes/detective_11.png',
                    phase: "ğŸ•µï¸ Detective - Phase 2: ì‹¬ë¬¸",
                    title: "ë…¼ë¦¬ì  ì••ë°•",
                    speaker: "ì§„",
                    content: "ì¦ê±°ëŠ” ëª…í™•í•´ìš”, ìœ ì§€ë¯¼ì”¨. ê³¼í•™ì  ë¶„ì„ ê²°ê³¼ë¥¼ ë¶€ì •í•  ìˆ˜ ìˆë‚˜ìš”?",
                    branch: "interrogation_route"
                },
                {
                    image: 'game/images/scenes/detective_05.png',
                    phase: "ğŸ•µï¸ Detective - Phase 3: ë²•ì • ìŠ¹ë¦¬",
                    title: "ì§„ì‹¤ ê·œëª…",
                    speaker: "ì§„",
                    content: "ì¡´ê²½í•˜ëŠ” ì¬íŒì¥ë‹˜, ê³¼í•™ì  ì¦ê±°ëŠ” ëª…í™•í•©ë‹ˆë‹¤. ë¬¼ë¦¬í•™ì€ ê±°ì§“ë§ì„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
                    ending: "ë…¼ë¦¬ì˜ ìŠ¹ë¦¬"
                }
            ],

            // Conspiracy Path
            conspiracy: [
                {
                    image: 'game/images/scenes/conspiracy_01.png',
                    phase: "ğŸ­ Conspiracy - Phase 1: ìˆ¨ê²¨ì§„ ì§„ì‹¤",
                    title: "êµ°ì‚¬ ê¸°ë°€ ë°œê²¬",
                    speaker: "ì§„",
                    content: "ì ê¹, ì´ ì—°êµ¬ ë°ì´í„°... ì´ê±´ ë‹¨ìˆœí•œ ì‚°ì—…ìš© ë¡œë´‡ì´ ì•„ë‹ˆì•¼. êµ°ì‚¬ìš© ììœ¨ ë¬´ê¸° ì‹œìŠ¤í…œ..."
                },
                {
                    image: 'game/images/scenes/conspiracy_02.png',
                    phase: "ğŸ­ Conspiracy - Phase 1: ìˆ¨ê²¨ì§„ ì§„ì‹¤",
                    title: "í•œê¸°íƒœì˜ ì •ì²´",
                    speaker: "í•œê¸°íƒœ",
                    content: "ë” ì´ìƒ ìˆ¨ê¸¸ í•„ìš”ê°€ ì—†ê² êµ°. ë‚˜ëŠ” êµ­ê°€ì •ë³´ì› ì†Œì†ì´ë‹¤. ì´ í”„ë¡œì íŠ¸ëŠ” êµ­ê°€ê¸°ë°€ì‚¬ì—…ì´ì—ˆì–´."
                },
                {
                    image: 'game/images/scenes/conspiracy_03.png',
                    phase: "ğŸ­ Conspiracy - Phase 1: ìˆ¨ê²¨ì§„ ì§„ì‹¤",
                    title: "ìœ ì§€ë¯¼ì˜ ê³ ë°±",
                    speaker: "ìœ ì§€ë¯¼",
                    content: "ì´ USBì— ëª¨ë“  ê²Œ ë‹´ê²¨ ìˆì–´ìš”. ì •ë¶€ì™€ ê¸°ì—…ì´ ì†ì¡ê³  ë¶ˆë²• ë¬´ê¸°ë¥¼ ê°œë°œí•˜ê³  ìˆì—ˆì–´ìš”."
                },
                {
                    image: 'game/images/scenes/conspiracy_06.png',
                    phase: "ğŸ­ Conspiracy - Phase 2: ìœ„í—˜í•œ ì¶”ì ",
                    title: "ì¶”ì  ë°©í–¥ ì„ íƒ",
                    speaker: "ì§„",
                    content: "ê±°ëŒ€í•œ ìŒëª¨ì˜ ì‹¤ì²´ê°€ ë“œëŸ¬ë‚˜ê³  ìˆë‹¤. ì–´ëŠ ìª½ì„ ë¨¼ì € íŒŒí—¤ì¹ ê¹Œ?",
                    choices: [
                        "ì •ë¶€ ì—°ê²°ê³ ë¦¬ë¥¼ ì¶”ì í•œë‹¤",
                        "ê¸°ì—… ë„¤íŠ¸ì›Œí¬ë¥¼ ì¡°ì‚¬í•œë‹¤"
                    ],
                    choice_types: ['government_route', 'corporate_route']
                },
                {
                    image: 'game/images/scenes/conspiracy_07.png',
                    phase: "ğŸ­ Conspiracy - Phase 2: ì •ë¶€ ì¶”ì ",
                    title: "ì„œë²„ì‹¤ ì¹¨ì…",
                    speaker: "ì§„",
                    content: "ì—¬ê¸°ê°€ ëª¨ë“  ë°ì´í„°ê°€ ì €ì¥ëœ ê³³ì´êµ°. ì •ë¶€ì™€ ê¸°ì—…ì´ ì–¼ë§ˆë‚˜ ê¹Šì´ ì—°ë£¨ë˜ì–´ ìˆëŠ”ì§€...",
                    branch: "government_route"
                },
                {
                    image: 'game/images/scenes/conspiracy_09.png',
                    phase: "ğŸ­ Conspiracy - Phase 2: ê¸°ì—… ì¶”ì ",
                    title: "ì¦ê±° ì¸ë©¸",
                    speaker: "ê¸°ì—… ì„ì›",
                    content: "ëª¨ë“  í•˜ë“œ ë“œë¼ì´ë¸Œë¥¼ íŒŒê¸°í•´! ì„œë¥˜ëŠ” ë‹¤ ì†Œê°í•˜ê³ !",
                    branch: "corporate_route"
                },
                {
                    image: 'game/images/scenes/conspiracy_13.png',
                    phase: "ğŸ­ Conspiracy - Phase 3: ê±°ëŒ€í•œ í­ë¡œ",
                    title: "ì§„ì‹¤ í­ë¡œ",
                    speaker: "ì•µì»¤",
                    content: "ì¶©ê²©ì ì¸ ì‚¬ì‹¤ì´ ë°í˜€ì¡ŒìŠµë‹ˆë‹¤. ì •ë¶€ì™€ ëŒ€ê¸°ì—…ì˜ ë¶ˆë²• AI ë¬´ê¸° ê°œë°œ...",
                    ending: "ê±°ëŒ€í•œ ê·¸ë¦¼ì"
                }
            ],

            // Drama Path
            drama: [
                {
                    image: 'game/images/scenes/drama_01.png',
                    phase: "ğŸ’” Drama - Phase 1: ê°ì •ì˜ ë°œê²¬",
                    title: "ê³¼ê±°ì˜ ê¸°ì–µ",
                    speaker: "ìœ ì§€ë¯¼",
                    content: "ê°•ë°•ì‚¬ë‹˜ê³¼ í•¨ê»˜ ì—°êµ¬í•˜ë˜ ì‹œì ˆì´ ê·¸ë¦¬ì›Œìš”... ê·¸ë•ŒëŠ” ì •ë§ í–‰ë³µí–ˆì–´ìš”."
                },
                {
                    image: 'game/images/scenes/drama_02.png',
                    phase: "ğŸ’” Drama - Phase 1: ê°ì •ì˜ ë°œê²¬",
                    title: "ì˜› ì—°ì¸ì˜ ë°œê²¬",
                    speaker: "ì§„",
                    content: "ì´ ì‚¬ì§„... ìœ ì§€ë¯¼ì”¨ì™€ í•œê¸°íƒœì”¨ê°€ í•¨ê»˜ ìˆëŠ” ëª¨ìŠµì´ë„¤ìš”. ê³¼ê±°ì— íŠ¹ë³„í•œ ê´€ê³„ì˜€ë‚˜ìš”?"
                },
                {
                    image: 'game/images/scenes/drama_03.png',
                    phase: "ğŸ’” Drama - Phase 1: ê°ì •ì˜ ë°œê²¬",
                    title: "ê³ ë°±ì˜ ìˆœê°„",
                    speaker: "ìœ ì§€ë¯¼",
                    content: "ì „ ì •ë§ë¡œ... ì •ë§ë¡œ ê°•ë°•ì‚¬ë‹˜ì„ ì£½ì´ë ¤ë˜ ê²Œ ì•„ë‹ˆì—ˆì–´ìš”! ìœ¼í‘..."
                },
                {
                    image: 'game/images/scenes/drama_06.png',
                    phase: "ğŸ’” Drama - Phase 2: ë³µì¡í•œ ê´€ê³„",
                    title: "ì ‘ê·¼ ë°©í–¥ ì„ íƒ",
                    speaker: "ì§„",
                    content: "ë³µì¡í•œ ì¸ê°„ê´€ê³„ê°€ ì–½í˜€ìˆë‹¤. ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼í• ê¹Œ?",
                    choices: [
                        "ìœ ì§€ë¯¼ì˜ ê³¼ê±°ë¥¼ ê¹Šì´ íŒŒë³¸ë‹¤",
                        "í•œê¸°íƒœì™€ì˜ ê´€ê³„ë¥¼ ì¤‘ì¬í•œë‹¤"
                    ],
                    choice_types: ['emotional_route', 'relationship_route']
                },
                {
                    image: 'game/images/scenes/drama_07.png',
                    phase: "ğŸ’” Drama - Phase 2: ê°ì • íƒêµ¬",
                    title: "ê°•ë°•ì‚¬ì˜ ì¼ê¸°",
                    speaker: "ì§„",
                    content: "ê°•ë°•ì‚¬ì˜ ì¼ê¸°... 'ìœ ì§€ë¯¼ì— ëŒ€í•œ ë§ˆìŒì„ ê³ ë°±í•  ìˆ˜ ì—†ì–´ì„œ...' ì¼ë°©ì ì¸ ì‚¬ë‘ì´ì—ˆêµ°ìš”.",
                    branch: "emotional_route"
                },
                {
                    image: 'game/images/scenes/drama_08.png',
                    phase: "ğŸ’” Drama - Phase 2: ê´€ê³„ íšŒë³µ",
                    title: "ê³¼ê±°ì™€ì˜ ëŒ€ë©´",
                    speaker: "ìœ ì§€ë¯¼",
                    content: "ê¸°íƒœì˜¤ë¹ ... ì™œ ê·¸ë•Œ ì•„ë¬´ ë§ ì—†ì´ ë– ë‚¬ì–´ìš”?",
                    branch: "relationship_route"
                },
                {
                    image: 'game/images/scenes/drama_13.png',
                    phase: "ğŸ’” Drama - Phase 3: ìš©ì„œì™€ êµ¬ì›",
                    title: "ì¸ê°„ì  íŒë‹¨",
                    speaker: "ì§„",
                    content: "ë²•ì ìœ¼ë¡œëŠ” ìœ ì£„ì§€ë§Œ... ì´ ì‚¬ê±´ì˜ ë³¸ì§ˆì€ ë‹¤ë¥´êµ°ìš”. ì¹˜ë£Œê°€ ìš°ì„ ì´ì—ìš”.",
                    ending: "ë§ˆìŒì˜ ì§„ì‹¤"
                }
            ]
        };

        function showDialogue() {
            let currentData;

            if (selectedPath === null) {
                // ê³µí†µ ë„ì…ë¶€
                if (currentDialogue >= dialogues.common.length) {
                    showDialogue(); // ê²½ë¡œ ì„ íƒìœ¼ë¡œ ì´ë™
                    return;
                }
                currentData = dialogues.common[currentDialogue];
            } else {
                // ì„ íƒëœ ê²½ë¡œì˜ ëŒ€ì‚¬
                const pathDialogues = dialogues[selectedPath];
                const adjustedIndex = currentDialogue - dialogues.common.length;

                if (adjustedIndex >= pathDialogues.length) {
                    // ê²Œì„ ì™„ë£Œ
                    showGameComplete();
                    return;
                }

                currentData = pathDialogues[adjustedIndex];

                // ë¶„ê¸° í•„í„°ë§ (branchê°€ ìˆëŠ” ê²½ìš°)
                if (currentData.branch && !currentData.branch.includes(getSubBranch())) {
                    nextDialogue();
                    return;
                }
            }

            // ë°°ê²½ ì´ë¯¸ì§€ í‘œì‹œ
            showDialogueImage(currentData.image);

            // UI ì—…ë°ì´íŠ¸
            document.getElementById('phaseIndicator').textContent = currentData.phase;
            document.getElementById('sceneNumber').textContent = currentData.title;
            document.getElementById('characterName').textContent = currentData.speaker || "ë‚´ë ˆì´ì…˜";
            document.getElementById('dialogueText').innerHTML = currentData.content;

            // ê²½ë¡œ í‘œì‹œê¸° ì—…ë°ì´íŠ¸
            updatePathIndicator();

            // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
            updateProgress();

            // ì—”ë”© í‘œì‹œ
            if (currentData.ending) {
                showEnding(currentData.ending);
            }

            // ì„ íƒì§€ ì²˜ë¦¬
            if (currentData.choices) {
                showChoices(currentData.choices, currentData.choice_types);
                document.getElementById('vnContinue').style.display = 'none';
            } else {
                hideChoices();
                document.getElementById('vnContinue').style.display = 'flex';
            }
        }

        function showDialogueImage(imagePath) {
            const imageElement = document.getElementById('sceneImage');
            if (imagePath) {
                imageElement.style.display = 'block';
                imageElement.src = imagePath;
                imageElement.onload = () => console.log(`âœ… Image loaded: ${imagePath}`);
                imageElement.onerror = () => {
                    console.log(`âš ï¸ Image not found: ${imagePath}`);
                    // ê¸°ë³¸ ì´ë¯¸ì§€ë¡œ ëŒ€ì²´
                    imageElement.src = 'game/images/scenes/scene_01.png';
                };
            } else {
                imageElement.style.display = 'none';
            }
        }

        function showChoices(choices, choiceTypes) {
            const choicesDiv = document.getElementById('vnChoices');
            choicesDiv.innerHTML = '';
            choicesDiv.style.display = 'block';

            choices.forEach((choice, index) => {
                const choiceDiv = document.createElement('div');
                choiceDiv.className = 'vn-choice';

                if (choiceTypes) {
                    const choiceType = choiceTypes[index];
                    if (['detective', 'evidence_route', 'interrogation_route'].includes(choiceType)) {
                        choiceDiv.classList.add('choice-detective');
                    } else if (['conspiracy', 'government_route', 'corporate_route'].includes(choiceType)) {
                        choiceDiv.classList.add('choice-conspiracy');
                    } else if (['drama', 'emotional_route', 'relationship_route'].includes(choiceType)) {
                        choiceDiv.classList.add('choice-drama');
                    }
                }

                choiceDiv.textContent = choice;
                choiceDiv.onclick = () => handleChoice(index, choiceTypes);
                choicesDiv.appendChild(choiceDiv);
            });
        }

        function hideChoices() {
            document.getElementById('vnChoices').style.display = 'none';
        }

        function handleChoice(choiceIndex, choiceTypes) {
            if (choiceTypes) {
                const choiceType = choiceTypes[choiceIndex];

                // ë©”ì¸ ê²½ë¡œ ì„ íƒ
                if (['detective', 'conspiracy', 'drama'].includes(choiceType)) {
                    selectedPath = choiceType;
                    currentDialogue = dialogues.common.length; // ê³µí†µë¶€ ê±´ë„ˆë›°ê¸°
                } else {
                    // ì„œë¸Œ ë¶„ê¸° ì„¤ì •
                    setSubBranch(choiceType);
                }

                // ì„ íƒ í”¼ë“œë°± í‘œì‹œ
                showChoiceFeedback(choiceType);
            }

            setTimeout(() => {
                nextDialogue();
            }, 1500);
        }

        function showChoiceFeedback(choiceType) {
            const pathNames = {
                detective: "ğŸ•µï¸ Detective Path - ë…¼ë¦¬ì˜ ìŠ¹ë¦¬",
                conspiracy: "ğŸ­ Conspiracy Path - ê±°ëŒ€í•œ ê·¸ë¦¼ì",
                drama: "ğŸ’” Human Drama Path - ë§ˆìŒì˜ ì§„ì‹¤",
                evidence_route: "ì¦ê±° ìˆ˜ì§‘ ê²½ë¡œ",
                interrogation_route: "ì‹¬ë¬¸ ê²½ë¡œ",
                government_route: "ì •ë¶€ ìŒëª¨ ì¶”ì ",
                corporate_route: "ê¸°ì—… ë¶€íŒ¨ ì¶”ì ",
                emotional_route: "ê°ì •ì  íƒêµ¬",
                relationship_route: "ê´€ê³„ íšŒë³µ ì§‘ì¤‘"
            };

            const feedbackDiv = document.createElement('div');
            feedbackDiv.className = 'choice-feedback';
            feedbackDiv.innerHTML = `ğŸ¯ ì„ íƒ: ${pathNames[choiceType] || choiceType}`;

            const dialogueBox = document.querySelector('.vn-dialogue-box');
            dialogueBox.appendChild(feedbackDiv);
        }

        function updatePathIndicator() {
            const pathIndicator = document.getElementById('pathIndicator');

            if (selectedPath) {
                const pathNames = {
                    detective: "ğŸ•µï¸ Detective Path",
                    conspiracy: "ğŸ­ Conspiracy Path",
                    drama: "ğŸ’” Drama Path"
                };

                pathIndicator.textContent = pathNames[selectedPath];
                pathIndicator.className = `vn-path-indicator path-${selectedPath}`;
                pathIndicator.style.display = 'inline-block';
            } else {
                pathIndicator.style.display = 'none';
            }
        }

        function updateProgress() {
            let totalScenes;
            let currentProgress;

            if (selectedPath === null) {
                totalScenes = dialogues.common.length;
                currentProgress = currentDialogue + 1;
            } else {
                totalScenes = dialogues.common.length + dialogues[selectedPath].length;
                currentProgress = dialogues.common.length + (currentDialogue - dialogues.common.length) + 1;
            }

            const progress = (currentProgress / totalScenes) * 100;
            document.getElementById('progressBar').style.width = Math.min(progress, 100) + '%';
        }

        function showEnding(endingTitle) {
            const endingDiv = document.getElementById('endingTitle');
            endingDiv.textContent = endingTitle;
            endingDiv.classList.remove('hidden');

            setTimeout(() => {
                endingDiv.classList.add('hidden');
            }, 3000);
        }

        function showGameComplete() {
            document.getElementById('vnContinue').innerHTML = '<div class="continue-indicator">ğŸ”„</div>';
            document.getElementById('vnContinue').onclick = () => restartGame();

            const dialogueBox = document.querySelector('.vn-dialogue-box .vn-text');
            dialogueBox.innerHTML = `
                <strong>ê²Œì„ ì™„ë£Œ!</strong><br>
                ë‹¤ë¥¸ ê²½ë¡œë¥¼ ì„ íƒí•´ì„œ ë‹¤ë¥¸ ì—”ë”©ì„ ê²½í—˜í•´ë³´ì„¸ìš”.<br>
                ğŸ”„ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘í•©ë‹ˆë‹¤.
            `;
        }

        function nextDialogue() {
            currentDialogue++;
            showDialogue();
        }

        function restartGame() {
            currentDialogue = 0;
            selectedPath = null;
            pathPhase = 1;

            // UI ì´ˆê¸°í™”
            document.getElementById('pathIndicator').style.display = 'none';
            document.getElementById('endingTitle').classList.add('hidden');

            // ê³„ì†í•˜ê¸° ë²„íŠ¼ ë³µì›
            document.getElementById('vnContinue').innerHTML = '<div class="continue-indicator">â–¶</div>';
            document.getElementById('vnContinue').onclick = () => nextDialogue();

            showDialogue();
        }

        // ì„œë¸Œ ë¶„ê¸° ê´€ë¦¬
        let subBranch = null;

        function setSubBranch(branch) {
            subBranch = branch;
        }

        function getSubBranch() {
            return subBranch;
        }

        // ê²Œì„ ì‹œì‘
        showDialogue();
    </script>
</body>
</html>