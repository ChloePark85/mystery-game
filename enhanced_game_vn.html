<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0ì˜ ì§‘í–‰ - ë¹„ì£¼ì–¼ ë…¸ë²¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            font-family: 'Segoe UI', 'Noto Sans CJK KR', sans-serif;
            height: 100%;
            overflow: hidden;
        }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .vn-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: #000;
        }

        /* í’€ìŠ¤í¬ë¦° ë°°ê²½ ì´ë¯¸ì§€ */
        .vn-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .vn-bg-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.8);
        }

        /* ìƒë‹¨ í—¤ë” */
        .vn-header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            z-index: 10;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), rgba(0,0,0,0));
            padding: 20px;
            color: white;
        }

        .vn-title {
            font-size: 1.5em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .vn-progress {
            width: 300px;
            height: 4px;
            background: rgba(255,255,255,0.3);
            border-radius: 2px;
            margin: 10px 0 5px 0;
        }

        .vn-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4fc3f7, #29b6f6);
            border-radius: 2px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .vn-scene-info {
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* í•˜ë‹¨ ëŒ€í™” UI */
        .vn-dialogue-container {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 10;
            background: linear-gradient(to top, rgba(0,0,0,0.9), rgba(0,0,0,0.7));
            padding: 20px;
            min-height: 200px;
        }

        /* ìºë¦­í„° ì´ë¦„ ë°•ìŠ¤ */
        .vn-character-name {
            background: rgba(66, 165, 245, 0.9);
            color: white;
            padding: 8px 20px;
            border-radius: 20px 20px 0 0;
            font-weight: bold;
            display: inline-block;
            margin-bottom: -1px;
            font-size: 0.95em;
        }

        /* ëŒ€í™” ë°•ìŠ¤ */
        .vn-dialogue-box {
            background: rgba(255,255,255,0.95);
            color: #333;
            padding: 20px;
            border-radius: 10px;
            min-height: 100px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .vn-text {
            font-size: 1.1em;
            line-height: 1.6;
        }

        /* ì„ íƒì§€ */
        .vn-choices {
            margin-top: 15px;
        }

        .vn-choice {
            background: rgba(66, 165, 245, 0.9);
            color: white;
            padding: 12px 20px;
            margin: 8px 0;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
            font-size: 1em;
        }

        .vn-choice:hover {
            background: rgba(66, 165, 245, 1);
            border-color: rgba(255,255,255,0.5);
            transform: scale(1.02);
        }

        /* ê³„ì†í•˜ê¸° ë²„íŠ¼ */
        .vn-continue {
            position: absolute;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: rgba(66, 165, 245, 0.8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            animation: pulse 2s infinite;
        }

        .vn-continue:hover {
            background: rgba(66, 165, 245, 1);
            transform: scale(1.1);
        }

        .continue-indicator {
            color: white;
            font-size: 1.2em;
            font-weight: bold;
            margin-left: 3px;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* ì‚¬ì´ë“œ ì •ë³´ */
        .vn-side-info {
            position: absolute;
            top: 100px;
            right: 20px;
            z-index: 5;
            width: 250px;
        }

        .vn-evidence {
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 2px solid rgba(76, 175, 80, 0.5);
        }

        .evidence-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #4caf50;
        }

        .vn-suspicion {
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid rgba(255, 152, 0, 0.5);
        }

        .suspicion-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #ff9800;
        }

        .suspect-bar {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .suspect-label {
            width: 60px;
            font-size: 0.9em;
        }

        .suspicion-fill {
            flex: 1;
            height: 8px;
            background: #333;
            border-radius: 4px;
            margin-left: 10px;
            overflow: hidden;
            position: relative;
        }

        .suspicion-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: linear-gradient(90deg, #ff9800, #f44336);
            border-radius: 4px;
            width: var(--suspicion-width, 0%);
            transition: width 0.5s ease;
        }

        /* í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .character {
            color: #2196f3;
            font-weight: bold;
        }

        .thought {
            color: #ff9800;
            font-style: italic;
            background: rgba(255, 152, 0, 0.1);
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 3px solid #ff9800;
        }

        .choice-feedback {
            background: rgba(33, 150, 243, 0.2);
            color: #2196f3;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .hidden {
            display: none !important;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .vn-side-info {
                width: 200px;
                top: 80px;
                right: 10px;
            }

            .vn-dialogue-container {
                padding: 15px;
            }

            .vn-header {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="vn-container">
        <!-- ë°°ê²½ ì´ë¯¸ì§€ (í’€ìŠ¤í¬ë¦°) -->
        <div class="vn-background">
            <img id="sceneImage" class="vn-bg-image" src="" alt="Scene Background">
        </div>

        <!-- ìƒë‹¨ ì •ë³´ -->
        <div class="vn-header">
            <div class="vn-title">0ì˜ ì§‘í–‰</div>
            <div class="vn-progress">
                <div class="vn-progress-bar" id="progressBar"></div>
            </div>
            <div class="vn-scene-info">
                <span id="phaseIndicator"></span> - <span id="sceneNumber"></span>
            </div>
        </div>

        <!-- í•˜ë‹¨ ëŒ€í™” UI -->
        <div class="vn-dialogue-container">
            <!-- ìºë¦­í„° ì´ë¦„ ë°•ìŠ¤ -->
            <div class="vn-character-name" id="characterName">ë‚´ë ˆì´ì…˜</div>

            <!-- ëŒ€í™” ë‚´ìš© ë°•ìŠ¤ -->
            <div class="vn-dialogue-box">
                <div class="vn-text" id="dialogueText">
                    <!-- ëŒ€í™” ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ì„ íƒì§€ -->
            <div class="vn-choices" id="vnChoices"></div>

            <!-- ê³„ì†í•˜ê¸° ë²„íŠ¼ -->
            <div class="vn-continue" id="vnContinue" onclick="nextDialogue()">
                <div class="continue-indicator">â–¶</div>
            </div>
        </div>

        <!-- ì‚¬ì´ë“œ ì •ë³´ (ì¦ê±°, ì˜í˜¹ë„ ë“±) -->
        <div class="vn-side-info">
            <div id="evidenceList" class="vn-evidence hidden">
                <div class="evidence-title">ğŸ” ì¦ê±°</div>
                <div id="evidenceItems"></div>
            </div>

            <div id="suspicionMeter" class="vn-suspicion hidden">
                <div class="suspicion-title">âš ï¸ ì˜í˜¹ë„</div>
                <div class="suspicion-bars">
                    <div class="suspect-bar">
                        <div class="suspect-label">ìœ ì§€ë¯¼</div>
                        <div class="suspicion-fill" id="yujimin-suspicion"></div>
                    </div>
                    <div class="suspect-bar">
                        <div class="suspect-label">í•œê¸°íƒœ</div>
                        <div class="suspicion-fill" id="hankitae-suspicion"></div>
                    </div>
                    <div class="suspect-bar">
                        <div class="suspect-label">AIë…¸ì•„</div>
                        <div class="suspicion-fill" id="noah-suspicion"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentDialogue = 0;
        let evidenceFound = [];
        let suspicion = {yujimin: 0, hankitae: 0, noah: 0};
        let wrongChoices = 0;
        let selectedBranch = null;

        // ëŒ€ì‚¬ë³„ ë°ì´í„° (ì´ë¯¸ì§€ í•˜ë‚˜ë‹¹ ëŒ€ì‚¬ í•˜ë‚˜)
        const dialogues = [
            // Scene 1: ê¸´ê¸‰ í˜¸ì¶œ
            {
                image: 'game/images/scenes/scene_01.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "ê¸´ê¸‰ í˜¸ì¶œ",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `<strong>2024ë…„ 3ì›” 15ì¼, ì˜¤í›„ 11ì‹œ 30ë¶„</strong><br>ì„œìš¸ ê°•ë‚¨êµ¬ ë°ì´í„° í¬ë Œì‹ ì‚¬ë¬´ì†Œ`
            },
            {
                image: 'game/images/scenes/scene_01.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "ê¸´ê¸‰ í˜¸ì¶œ",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `ì „í™”ë²¨ì´ ìš¸ë¦°ë‹¤. ë°¤ëŠ¦ì€ ì‹œê°„ì˜ í˜¸ì¶œì€ ë³´í†µ ì¤‘ìš”í•œ ì‚¬ê±´ì„ ì˜ë¯¸í•œë‹¤.`
            },
            {
                image: 'game/images/scenes/scene_01.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "ê¸´ê¸‰ í˜¸ì¶œ",
                speaker: "ê²½ì°°ì„œ",
                content: `ì§„ íƒì •ë‹˜, ê¸´ê¸‰ì‚¬ê±´ì…ë‹ˆë‹¤. ê°•ë‚¨êµ¬ ì•„ë¥´ì¹´ë””ì•„ ë§¨ì…˜ì—ì„œ ì˜ë¬¸ì‚¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í˜„ì¥ìœ¼ë¡œ ì¶œë™ ê°€ëŠ¥í•˜ì‹­ë‹ˆê¹Œ?`
            },
            {
                image: 'game/images/scenes/scene_01.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "ê¸´ê¸‰ í˜¸ì¶œ",
                speaker: "ì§„ (ìƒê°)",
                content: `ë˜ ë‹¤ë¥¸ ë°ì´í„° í¼ì¦ì´ ì‹œì‘ëœë‹¤. ì¸ê°„ì€ ê±°ì§“ë§ì„ í•˜ì§€ë§Œ, ë°ì´í„°ëŠ” ê·¸ë ‡ì§€ ì•Šë‹¤.`
            },

            // Scene 2: í˜„ì¥ ë„ì°©
            {
                image: 'game/images/scenes/scene_02.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "í˜„ì¥ ë„ì°©",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `<strong>ì˜¤í›„ 11ì‹œ 50ë¶„</strong><br>ì•„ë¥´ì¹´ë””ì•„ ë§¨ì…˜ ì•`
            },
            {
                image: 'game/images/scenes/scene_02.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "í˜„ì¥ ë„ì°©",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `ì²¨ë‹¨ ê¸°ìˆ ë¡œ ë¬´ì¥í•œ ìŠ¤ë§ˆíŠ¸ ë§¨ì…˜. ëª¨ë“  ê²ƒì´ ìë™í™”ë˜ì–´ ìˆë‹¤.`
            },
            {
                image: 'game/images/scenes/scene_02.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "í˜„ì¥ ë„ì°©",
                speaker: "ê²½ì°°ê´€",
                content: `ì§„ íƒì •ë‹˜, ê¸°ë‹¤ë¦¬ê³  ìˆì—ˆìŠµë‹ˆë‹¤. í”¼í•´ìëŠ” ê°•ë°•ì‚¬(58ì„¸), ì»´í“¨í„° ê³µí•™ êµìˆ˜ì…ë‹ˆë‹¤.`
            },

            // Scene 3: ì‚¬ê±´ ë¸Œë¦¬í•‘
            {
                image: 'game/images/scenes/scene_03.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "ì‚¬ê±´ ë¸Œë¦¬í•‘",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `í˜„ì¥ì€ ì§€í•˜ ì—°êµ¬ì‹¤ì…ë‹ˆë‹¤. ê°•ë°•ì‚¬ê°€ ë¡œë´‡ íŒ”ì— ëª©ì´ ëˆŒë ¤ ì‚¬ë§í•œ ìƒíƒœë¡œ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.`
            },
            {
                image: 'game/images/scenes/scene_03.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "ì‚¬ê±´ ë¸Œë¦¬í•‘",
                speaker: "ê²½ì°°ê´€",
                content: `í˜„ì¥ì—ëŠ” ë‘ ëª…ì˜ ê´€ë ¨ìê°€ ìˆìŠµë‹ˆë‹¤. ì¡°ìˆ˜ ìœ ì§€ë¯¼ê³¼ íˆ¬ìì í•œê¸°íƒœì…ë‹ˆë‹¤.`
            },
            {
                image: 'game/images/scenes/scene_03.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "ì‚¬ê±´ ë¸Œë¦¬í•‘",
                speaker: "ì§„ (ìƒê°)",
                content: `ìŠ¤ë§ˆíŠ¸ ë§¨ì…˜, ë¡œë´‡ íŒ”, ê·¸ë¦¬ê³  ë‘ ëª…ì˜ ìš©ì˜ì. ë°ì´í„°ê°€ ì§„ì‹¤ì„ ë§í•´ì¤„ ê²ƒì´ë‹¤.`
            },

            // Scene 4: ì—°êµ¬ì‹¤ ì…ì¥
            {
                image: 'game/images/scenes/scene_04.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "ì—°êµ¬ì‹¤ ì…ì¥",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `<strong>ìì •</strong><br>ì§€í•˜ ì—°êµ¬ì‹¤ ì…êµ¬`
            },
            {
                image: 'game/images/scenes/scene_04.png',
                phase: "Phase 1: ì‚¬ê±´ ë°œìƒ",
                title: "ì—°êµ¬ì‹¤ ì…ì¥",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `ì—˜ë¦¬ë² ì´í„° ë¬¸ì´ ì—´ë¦¬ë©° ì°¨ê°€ìš´ ê³µê¸°ê°€ í˜ëŸ¬ë‚˜ì˜¨ë‹¤. ì²¨ë‹¨ ì—°êµ¬ì‹œì„¤ì˜ ëƒ„ìƒˆê°€ ë‚œë‹¤.`
            },

            // Scene 5: ì—°êµ¬ì‹¤ ì „ì²´ ê´€ì°°
            {
                image: 'game/images/scenes/scene_05.png',
                phase: "Phase 2: í˜„ì¥ ì¡°ì‚¬",
                title: "ì—°êµ¬ì‹¤ ì „ì²´ ê´€ì°°",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `ì™„ë²½í•˜ê²Œ ì •ë¦¬ëœ ì—°êµ¬ì‹¤. ì¤‘ì•™ì— ê±°ëŒ€í•œ ì‚°ì—…ìš© ë¡œë´‡ íŒ”ì´ ìœ„ì¹˜í•´ ìˆë‹¤.`
            },
            {
                image: 'game/images/scenes/scene_05.png',
                phase: "Phase 2: í˜„ì¥ ì¡°ì‚¬",
                title: "ì—°êµ¬ì‹¤ ì „ì²´ ê´€ì°°",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `ê°•ë°•ì‚¬ì˜ ì‹œì‹ ì€ ì´ë¯¸ ì˜®ê²¨ì¡Œì§€ë§Œ, ë°”ë‹¥ì— ë¶„í•„ë¡œ í‘œì‹œëœ ìœ¤ê³½ì´ ë‚¨ì•„ìˆë‹¤.`
            },
            {
                image: 'game/images/scenes/scene_05.png',
                phase: "Phase 2: í˜„ì¥ ì¡°ì‚¬",
                title: "ì—°êµ¬ì‹¤ ì „ì²´ ê´€ì°°",
                speaker: "ì§„ (ìƒê°)",
                content: `ë„ˆë¬´ ê¹¨ë—í•˜ë‹¤. ì‚¬ê³ ì˜€ë‹¤ë©´ í˜¼ë€ì˜ í”ì ì´ ìˆì–´ì•¼ í•˜ëŠ”ë°...`
            },
            {
                image: 'game/images/scenes/scene_05.png',
                phase: "Phase 2: í˜„ì¥ ì¡°ì‚¬",
                title: "ìˆ˜ì‚¬ ë°©í–¥ ì„ íƒ",
                speaker: "ì§„",
                content: `ì–´ë””ë¶€í„° ì¡°ì‚¬ë¥¼ ì‹œì‘í• ê¹Œ?`,
                choices: [
                    "ë¡œë´‡ íŒ”ì„ ì •ë°€ ê²€ì‚¬í•œë‹¤",
                    "ì œì–´ íŒ¨ë„ì„ í™•ì¸í•œë‹¤",
                    "ì£¼ë³€ ê¸°ê¸°ë¥¼ ì‚´í´ë³¸ë‹¤"
                ],
                choice_outcomes: [
                    { branch: "physical_evidence", description: "ë¬¼ë¦¬ì  ì¦ê±° ì¤‘ì‹¬ì˜ ìˆ˜ì‚¬" },
                    { branch: "digital_evidence", description: "ë””ì§€í„¸ í¬ë Œì‹ ì¤‘ì‹¬ì˜ ìˆ˜ì‚¬" },
                    { branch: "environmental_evidence", description: "í™˜ê²½ ë¶„ì„ ì¤‘ì‹¬ì˜ ìˆ˜ì‚¬" }
                ]
            },

            // ë¡œë´‡ íŒ” ì •ë°€ ê²€ì‚¬ ê²½ë¡œ
            {
                image: 'game/images/scenes/scene_06.png',
                phase: "Phase 2: í˜„ì¥ ì¡°ì‚¬",
                title: "ë¡œë´‡ íŒ” ì •ë°€ ê²€ì‚¬",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `ë¡œë´‡ íŒ”ì„ ìì„¸íˆ ì‚´í´ë³¸ë‹¤. ê´€ì ˆ ë¶€ë¶„ì— ë­”ê°€ ê±¸ë ¤ìˆë‹¤.`
            },
            {
                image: 'game/images/scenes/scene_06.png',
                phase: "Phase 2: í˜„ì¥ ì¡°ì‚¬",
                title: "ë¡œë´‡ íŒ” ì •ë°€ ê²€ì‚¬",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `ê²€ì€ìƒ‰ ì²œ ì¡°ê°ì´ ê¸°ê³„ ê´€ì ˆ ì‚¬ì´ì— ë¼ì–´ìˆë‹¤. ë„¥íƒ€ì´ì˜ ì¼ë¶€ì¸ ê²ƒ ê°™ë‹¤.`,
                evidence: 'robot_fiber'
            },

            // ìµœì¢… ë²”ì¸ ì§€ëª©
            {
                image: 'game/images/scenes/scene_22.png',
                phase: "Phase 4: ì¶”ë¦¬ ë° í•´ê²°",
                title: "ë²”ì¸ ì§€ëª©",
                speaker: "ì§„",
                content: `ëª¨ë“  ì¦ê±°ë¥¼ ì¢…í•©í•œ ê²°ê³¼, ë²”ì¸ì€...`,
                choices: [
                    "ìœ ì§€ë¯¼ (ì¡°ìˆ˜) - ë‚´ë¶€ ë²”í–‰",
                    "í•œê¸°íƒœ (íˆ¬ìì) - ê²½ì œì  ë™ê¸°",
                    "ì‚¬ê³ ì‚¬ - ì‹œìŠ¤í…œ ì˜¤ë¥˜"
                ],
                choice_outcomes: [
                    { branch: "ending_yujimin", description: "ìœ ì§€ë¯¼ ë²”ì¸ ë£¨íŠ¸" },
                    { branch: "ending_hankitae", description: "í•œê¸°íƒœ ë²”ì¸ ë£¨íŠ¸" },
                    { branch: "ending_accident", description: "ì‚¬ê³ ì‚¬ ê²°ë¡  ë£¨íŠ¸" }
                ]
            },

            // ì—”ë”© A: ìœ ì§€ë¯¼ ë²”ì¸
            {
                image: 'game/images/scenes/scene_23.png',
                phase: "ì—”ë”© A: ë‚´ë¶€ì ë²”í–‰",
                title: "ìœ ì§€ë¯¼ ì²´í¬",
                speaker: "ì§„",
                content: `ìœ ì§€ë¯¼ ì”¨, ë‹¹ì‹ ì´ ê°•ë°•ì‚¬ë¥¼ ì‚´í•´í–ˆìŠµë‹ˆë‹¤.`,
                branch: "ending_yujimin"
            },
            {
                image: 'game/images/scenes/scene_24.png',
                phase: "ì—”ë”© A: ë‚´ë¶€ì ë²”í–‰",
                title: "ì •ì˜ êµ¬í˜„",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `ë°ì´í„°ê°€ ë°íŒ ì§„ì‹¤. ê¸°ìˆ ì€ ì™„ë²½í•œ ì¦ì¸ì´ì—ˆë‹¤.`,
                branch: "ending_yujimin"
            },

            // ì—”ë”© B: í•œê¸°íƒœ ë²”ì¸
            {
                image: 'game/images/scenes/scene_23.png',
                phase: "ì—”ë”© B: íˆ¬ìì ìŒëª¨",
                title: "í•œê¸°íƒœ ì¶”ê¶",
                speaker: "ì§„",
                content: `í•œê¸°íƒœ ì”¨, íˆ¬ìê¸ˆ íšŒìˆ˜ë¥¼ ìœ„í•œ ë²”í–‰ì´êµ°ìš”.`,
                branch: "ending_hankitae"
            },
            {
                image: 'game/images/scenes/scene_24.png',
                phase: "ì—”ë”© B: íˆ¬ìì ìŒëª¨",
                title: "íƒìš•ì˜ ëŒ€ê°€",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `ëˆì´ ë¶€ë¥¸ ë¹„ê·¹. íˆ¬ììì˜ íƒìš•ì´ ìƒëª…ì„ ì•—ì•„ê°”ë‹¤.`,
                branch: "ending_hankitae"
            },

            // ì—”ë”© C: ì‚¬ê³ ì‚¬
            {
                image: 'game/images/scenes/scene_23.png',
                phase: "ì—”ë”© C: ì‹œìŠ¤í…œì˜ í•¨ì •",
                title: "ê¸°ìˆ ì  ê²°ë¡ ",
                speaker: "ì§„",
                content: `ì´ê²ƒì€ ë²”ì£„ê°€ ì•„ë‹™ë‹ˆë‹¤. ì‹œìŠ¤í…œ ì˜¤ë¥˜ë¡œ ì¸í•œ ì‚¬ê³ ì…ë‹ˆë‹¤.`,
                branch: "ending_accident"
            },
            {
                image: 'game/images/scenes/scene_24.png',
                phase: "ì—”ë”© C: ì‹œìŠ¤í…œì˜ í•¨ì •",
                title: "ê¸°ìˆ ì— ëŒ€í•œ ì„±ì°°",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `ì¸ê°„ì´ ë§Œë“  ê¸°ìˆ , í•˜ì§€ë§Œ ê·¸ ê¸°ìˆ ì´ ì¸ê°„ì„ í†µì œí•  ë•Œì˜ ìœ„í—˜ì„±ì„ ë³´ì—¬ì¤€ ì‚¬ê±´ì´ì—ˆë‹¤.`,
                branch: "ending_accident"
            },

            // ê³µí†µ ì—í•„ë¡œê·¸
            {
                image: 'game/images/scenes/scene_25.png',
                phase: "ì—í•„ë¡œê·¸",
                title: "ì‚¬ê±´ ì™„ë£Œ",
                speaker: "ë‚´ë ˆì´ì…˜",
                content: `ë˜ í•˜ë‚˜ì˜ ì‚¬ê±´ì´ ì¢…ë£Œë˜ì—ˆë‹¤. ê°ìì˜ ì§„ì‹¤ì´ ìˆì—ˆë‹¤.`
            },
            {
                image: 'game/images/scenes/scene_25.png',
                phase: "ì—í•„ë¡œê·¸",
                title: "ì‚¬ê±´ ì™„ë£Œ",
                speaker: "ì§„ (ìƒê°)",
                content: `ë°ì´í„°ëŠ” ì‚¬ì‹¤ì„ ë§í•˜ì§€ë§Œ, ì§„ì‹¤ì€ í•´ì„í•˜ëŠ” ì‚¬ëŒì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤...`
            }
        ];

        function showDialogue() {
            // ë¶„ê¸° í•„í„°ë§
            while (currentDialogue < dialogues.length) {
                const dialogue = dialogues[currentDialogue];

                if (dialogue.branch && selectedBranch && dialogue.branch !== selectedBranch) {
                    currentDialogue++;
                    continue;
                }

                if (dialogue.branch && !selectedBranch) {
                    currentDialogue++;
                    continue;
                }

                break;
            }

            if (currentDialogue >= dialogues.length) {
                // ê²Œì„ ì™„ë£Œ
                document.getElementById('vnContinue').innerHTML = '<div class="continue-indicator">ğŸ”„</div>';
                document.getElementById('vnContinue').onclick = () => restartGame();
                return;
            }

            const dialogue = dialogues[currentDialogue];

            // ë°°ê²½ ì´ë¯¸ì§€ í‘œì‹œ
            showDialogueImage(dialogue.image);

            // í˜ì´ì¦ˆì™€ ì¥ë©´ ì •ë³´ í‘œì‹œ
            document.getElementById('phaseIndicator').textContent = dialogue.phase;
            document.getElementById('sceneNumber').textContent = dialogue.title;

            // ìºë¦­í„° ì´ë¦„ê³¼ ëŒ€í™” ë‚´ìš© í‘œì‹œ
            document.getElementById('characterName').textContent = dialogue.speaker || "ë‚´ë ˆì´ì…˜";
            document.getElementById('dialogueText').innerHTML = dialogue.content;

            // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
            updateProgress();

            // ì¦ê±° ì¶”ê°€
            if (dialogue.evidence && !evidenceFound.includes(dialogue.evidence)) {
                evidenceFound.push(dialogue.evidence);
                updateEvidenceList();
            }

            // ì„ íƒì§€ ì²˜ë¦¬
            if (dialogue.choices) {
                showVNChoices(dialogue.choices);
            } else {
                showVNContinue();
            }

            // ìŠ¤í¬ë¡¤ ë°©ì§€ë¥¼ ìœ„í•œ í•˜ë‹¨ ê³ ì •
            document.getElementById('vnContinue').style.display = dialogue.choices ? 'none' : 'flex';
        }

        function showDialogueImage(imagePath) {
            const imageElement = document.getElementById('sceneImage');
            if (imagePath) {
                imageElement.style.display = 'block';
                imageElement.src = imagePath;
                imageElement.onload = function() {
                    console.log(`âœ… Dialogue image loaded: ${imagePath}`);
                };
                imageElement.onerror = function() {
                    console.log(`âš ï¸ Dialogue image not found: ${imagePath}`);
                    imageElement.style.display = 'none';
                };
            } else {
                imageElement.style.display = 'none';
            }
        }

        function showVNChoices(choices) {
            const choicesDiv = document.getElementById('vnChoices');
            choicesDiv.innerHTML = '';
            choicesDiv.style.display = 'block';

            choices.forEach((choice, index) => {
                const choiceDiv = document.createElement('div');
                choiceDiv.className = 'vn-choice';
                choiceDiv.textContent = choice;
                choiceDiv.onclick = () => handleChoice(index);
                choicesDiv.appendChild(choiceDiv);
            });
        }

        function showVNContinue() {
            document.getElementById('vnChoices').style.display = 'none';
            document.getElementById('vnContinue').style.display = 'flex';
        }

        function handleChoice(choiceIndex) {
            const currentDialogueData = dialogues[currentDialogue];

            if (currentDialogueData.choice_outcomes) {
                const outcome = currentDialogueData.choice_outcomes[choiceIndex];

                // ì„ íƒí•œ ë¶„ê¸° ì €ì¥
                if (outcome.branch) {
                    selectedBranch = outcome.branch;
                }

                // ì„ íƒ í”¼ë“œë°± í‘œì‹œ
                const feedbackDiv = document.createElement('div');
                feedbackDiv.className = 'choice-feedback';
                feedbackDiv.innerHTML = `ğŸ¯ ì„ íƒ: ${outcome.description}`;

                // í”¼ë“œë°±ì„ ëŒ€í™” ë°•ìŠ¤ì— í‘œì‹œ
                const dialogueBox = document.querySelector('.vn-dialogue-box');
                dialogueBox.appendChild(feedbackDiv);

                // 1.5ì´ˆ í›„ ë‹¤ìŒ ëŒ€ì‚¬ë¡œ ì§„í–‰
                setTimeout(() => {
                    nextDialogue();
                }, 1500);
            } else {
                nextDialogue();
            }
        }

        function updateProgress() {
            const progress = ((currentDialogue + 1) / dialogues.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function updateEvidenceList() {
            const evidenceNames = {
                robot_fiber: 'ë¡œë´‡ íŒ” ê´€ì ˆì˜ ë„¥íƒ€ì´ ì„¬ìœ ',
                shutdown_log: '21:00 ìë™ ì¢…ë£Œ ì‹œí€€ìŠ¤ ë¡œê·¸',
                power_pattern: '21:00 ë¹„ì •ìƒ ì „ë ¥ ì‚¬ìš© íŒ¨í„´',
                smartwatch_data: 'ê°•ë°•ì‚¬ ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ ìƒì²´ ë°ì´í„°'
            };

            if (evidenceFound.length > 0) {
                const evidenceDiv = document.getElementById('evidenceList');
                const itemsDiv = document.getElementById('evidenceItems');

                itemsDiv.innerHTML = '';
                evidenceFound.forEach(evidence => {
                    const item = document.createElement('div');
                    item.textContent = 'â€¢ ' + evidenceNames[evidence];
                    itemsDiv.appendChild(item);
                });

                evidenceDiv.classList.remove('hidden');
            }
        }

        function nextDialogue() {
            currentDialogue++;
            showDialogue();
        }

        function restartGame() {
            currentDialogue = 0;
            evidenceFound = [];
            suspicion = { yujimin: 0, hankitae: 0, noah: 0 };
            wrongChoices = 0;
            selectedBranch = null;

            // UI ì´ˆê¸°í™”
            document.getElementById('evidenceList').classList.add('hidden');
            document.getElementById('suspicionMeter').classList.add('hidden');

            // ê³„ì†í•˜ê¸° ë²„íŠ¼ ë³µì›
            document.getElementById('vnContinue').innerHTML = '<div class="continue-indicator">â–¶</div>';
            document.getElementById('vnContinue').onclick = () => nextDialogue();

            showDialogue();
        }

        // ê²Œì„ ì‹œì‘
        showDialogue();
    </script>
</body>
</html>